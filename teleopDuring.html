<!DOCTYPE html>
<!--
This is the html page for Teleop during the match.
-->
<html>
  <head>
    <meta charset="UTF-8">
    <title>Start Scouting Session</title>
    <link rel="stylesheet" type="text/css" href="./teleopDuringStyles.css"/>
  </head>
  <body>
    <script>
      function initialization() {

      }
      function signOut() {
        localStorage.setItem("currentScoutName", "");
        window.location.href = './enterScoutName.html';
      }
      function displayUserEntryAmount() {
        var XMLHttpRequest = require("xmlhttprequest").XMLHttpRequest;
        var url = "http://localhost:3000/user/getUser";
        var xhr = new XMLHttpRequest();
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        var jsonReq = {};
        jsonReq["username"] = localStorage.getItem("currentScoutName");
        xhr.send(JSON.stringify(jsonReq));
        xhr.onreadystatechange = proccessRequest;
        function proccessRequest(e) {
          if(xhr.status == 200) {
            var jsonResponse = JSON.parse(xhr.responseText);
            var entryNumber = jsonResponse["submitted"];
            var alertString = localStorage.getItem("currentScoutName") + " has submitted " + entryNumber + " scouting entries over the course of the competition.";
            alert(alertString);
          }
        }
      }
    window.onload = initialization;
    </script>
    <ul id="navbar">
      <li id="scoutName" onclick="displayUserEntryAmount();"><script>document.write(localStorage.getItem("currentScoutName"));</script></li>
      <li id="title">Teleoperated Period</li>
      <li id="signOut" onclick="signOut();">Sign Out</li>
    </ul>
  </body>

  </html>
